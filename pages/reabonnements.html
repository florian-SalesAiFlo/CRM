<!-- ========================================================
     pages/reabonnements.html — Récap réabonnements
     Chargé dans #app par router.js.
     PAS de <script> ici. JS : js/reabonnements.js
     ======================================================== -->

<div class="page-layout">

  <!-- En-tête -->
  <header class="page-header">
    <div class="page-header-left">
      <h1 class="page-title">Réabonnements</h1>
      <span class="badge badge-secondary" id="reabo-count">—</span>
    </div>
  </header>

  <!-- KPIs -->
  <div class="kpi-row" id="reabo-kpi-row">
    <div class="kpi-card">
      <div class="kpi-icon kpi-icon-green">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
          <path d="M22 11.08V12a10 10 0 11-5.93-9.14"/><polyline points="22 4 12 14.01 9 11.01"/>
        </svg>
      </div>
      <div class="kpi-body">
        <div class="kpi-value" id="kpi-abo-actifs">—</div>
        <div class="kpi-label">Actifs</div>
      </div>
    </div>

    <div class="kpi-card">
      <div class="kpi-icon kpi-icon-orange">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
          <circle cx="12" cy="12" r="10"/><line x1="12" y1="8" x2="12" y2="12"/>
          <line x1="12" y1="16" x2="12.01" y2="16"/>
        </svg>
      </div>
      <div class="kpi-body">
        <div class="kpi-value" id="kpi-abo-bientot">—</div>
        <div class="kpi-label">Expire &lt; 30j</div>
      </div>
    </div>

    <div class="kpi-card">
      <div class="kpi-icon kpi-icon-red">
        <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
          <circle cx="12" cy="12" r="10"/>
          <line x1="15" y1="9" x2="9" y2="15"/><line x1="9" y1="9" x2="15" y2="15"/>
        </svg>
      </div>
      <div class="kpi-body">
        <div class="kpi-value" id="kpi-abo-expires">—</div>
        <div class="kpi-label">Expirés</div>
      </div>
    </div>
  </div>

  <!-- Filtres -->
  <div class="filter-bar">
    <select id="reabo-filter-statut" class="filter-select" aria-label="Filtrer par statut abonnement">
      <option value="">Tous les statuts</option>
      <option value="actif">Actif</option>
      <option value="en_attente">En attente</option>
      <option value="expire">Expiré</option>
      <option value="resilie">Résilié</option>
    </select>

    <select id="reabo-filter-reabo" class="filter-select" aria-label="Filtrer par renouvellement auto">
      <option value="">Renouvellement auto : tous</option>
      <option value="oui">Renouvellement auto : Oui</option>
      <option value="non">Renouvellement auto : Non</option>
    </select>
  </div>

  <!-- Tableau -->
  <div class="table-section">
    <div class="table-wrap">
      <table class="data-table" aria-label="Tableau des réabonnements">
        <thead>
          <tr>
            <th>Prospect</th>
            <th>Type abo</th>
            <th>Statut</th>
            <th>Fin d'abo</th>
            <th>Tarif / mois</th>
            <th class="col-center">Renouvt. auto</th>
            <th>Urgence</th>
          </tr>
        </thead>
        <tbody id="reabo-tbody">
          <tr><td colspan="7" class="empty-cell">Chargement…</td></tr>
        </tbody>
      </table>
    </div>
  </div>

</div>

<style>
  .page-layout {
    display: flex; flex-direction: column;
    height: 100%; overflow-y: auto;
    background: var(--color-bg);
  }
  .page-header {
    display: flex; align-items: center; justify-content: space-between;
    padding: var(--space-5) var(--space-6);
    background: var(--color-surface);
    border-bottom: 1px solid var(--color-border);
    flex-shrink: 0;
  }
  .page-header-left { display: flex; align-items: center; gap: var(--space-3); }
  .page-title { font-size: var(--text-xl); font-weight: 700; letter-spacing: -.03em; color: var(--color-text); }

  /* KPIs */
  .kpi-row {
    display: grid; grid-template-columns: repeat(3, 1fr);
    gap: var(--space-4); padding: var(--space-6);
    flex-shrink: 0;
  }
  @media (max-width: 700px) { .kpi-row { grid-template-columns: 1fr; } }
  .kpi-card {
    background: var(--color-surface); border: 1px solid var(--color-border);
    border-radius: var(--radius-md); padding: var(--space-5);
    display: flex; align-items: center; gap: var(--space-4);
    box-shadow: var(--shadow-sm);
  }
  .kpi-icon {
    width: 44px; height: 44px; border-radius: var(--radius-md);
    display: flex; align-items: center; justify-content: center; flex-shrink: 0;
  }
  .kpi-icon svg { width: 22px; height: 22px; }
  .kpi-icon-green  { background: var(--color-success-soft); color: var(--color-success); }
  .kpi-icon-orange { background: var(--color-warning-soft); color: var(--color-warning); }
  .kpi-icon-red    { background: var(--color-danger-soft);  color: var(--color-danger); }
  .kpi-body { min-width: 0; }
  .kpi-value { font-size: var(--text-2xl); font-weight: 700; color: var(--color-text); letter-spacing: -.03em; line-height: 1; }
  .kpi-label { font-size: var(--text-xs); color: var(--color-text-tertiary); margin-top: var(--space-1); text-transform: uppercase; letter-spacing: .05em; }

  /* Filtres */
  .filter-bar {
    display: flex; align-items: center; gap: var(--space-3);
    padding: var(--space-4) var(--space-6);
    background: var(--color-surface); border-bottom: 1px solid var(--color-border);
    flex-shrink: 0; flex-wrap: wrap;
  }
  .filter-select {
    padding: var(--space-2) var(--space-3);
    border: 1px solid var(--color-border); border-radius: var(--radius-sm);
    background: var(--color-bg); color: var(--color-text); font-size: var(--text-sm); cursor: pointer;
  }

  /* Tableau */
  .table-section { flex: 1; padding: var(--space-4) var(--space-6) var(--space-6); overflow: auto; }
  .table-wrap {
    background: var(--color-surface); border: 1px solid var(--color-border);
    border-radius: var(--radius-md); overflow: hidden;
  }
  .data-table { width: 100%; border-collapse: collapse; font-size: var(--text-sm); }
  .data-table th {
    padding: var(--space-3) var(--space-4); text-align: left;
    font-weight: 600; color: var(--color-text-secondary);
    background: var(--color-surface-alt); white-space: nowrap;
  }
  .data-table td {
    padding: var(--space-3) var(--space-4);
    border-top: 1px solid var(--color-border);
    color: var(--color-text); vertical-align: middle;
  }
  .data-table td a { color: var(--color-primary); text-decoration: none; font-weight: 500; }
  .data-table td a:hover { text-decoration: underline; }
  .col-center { text-align: center; }
  .empty-cell { text-align: center; color: var(--color-text-tertiary); padding: var(--space-8) !important; }

  /* Urgence rows */
  .row-ok      td { background: var(--color-success-soft); }
  .row-bientot td { background: var(--color-warning-soft); }
  .row-expire  td { background: var(--color-danger-soft); }

  /* Badge */
  .badge {
    display: inline-flex; align-items: center;
    padding: 2px var(--space-2); border-radius: 99px;
    font-size: var(--text-xs); font-weight: 600; white-space: nowrap;
  }
  .badge-success   { background: var(--color-success-soft); color: var(--color-success); }
  .badge-warning   { background: var(--color-warning-soft); color: var(--color-warning); }
  .badge-danger    { background: var(--color-danger-soft);  color: var(--color-danger); }
  .badge-secondary { background: var(--color-surface-alt);  color: var(--color-text-secondary); }
  .badge-info      { background: var(--color-info-soft);    color: var(--color-info); }
  .badge-primary   { background: var(--color-primary-soft); color: var(--color-primary); }
</style>
