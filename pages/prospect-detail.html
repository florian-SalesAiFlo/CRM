<!-- ========================================================
     pages/prospect-detail.html — Fiche prospect (lecture seule)
     Chargé dans #app par router.js via initPageScripts().
     PAS de <script> ici. JS : js/prospect-detail.js
     ======================================================== -->

<!-- ── Slide panels ──────────────────────────────────────── -->
<div class="slide-panel" id="panel-new-contact"
     role="dialog" aria-modal="true" aria-labelledby="panel-contact-title">
  <div class="slide-panel-header">
    <h2 id="panel-contact-title">Nouveau contact</h2>
    <button class="btn btn-ghost" data-panel-close aria-label="Fermer">✕</button>
  </div>
  <div class="slide-panel-body" id="panel-contact-body"></div>
</div>

<div class="slide-panel" id="panel-new-interaction"
     role="dialog" aria-modal="true" aria-labelledby="panel-interaction-title">
  <div class="slide-panel-header">
    <h2 id="panel-interaction-title">Nouvelle interaction</h2>
    <button class="btn btn-ghost" data-panel-close aria-label="Fermer">✕</button>
  </div>
  <div class="slide-panel-body" id="panel-interaction-body"></div>
</div>

<div class="slide-panel" id="panel-new-rappel"
     role="dialog" aria-modal="true" aria-labelledby="panel-rappel-title">
  <div class="slide-panel-header">
    <h2 id="panel-rappel-title">Nouveau rappel</h2>
    <button class="btn btn-ghost" data-panel-close aria-label="Fermer">✕</button>
  </div>
  <div class="slide-panel-body" id="panel-rappel-body"></div>
</div>

<!-- ── Page ─────────────────────────────────────────────── -->
<div class="detail-layout" id="detail-root">

  <!-- Loading state -->
  <div id="detail-loading" class="detail-loading" aria-live="polite">
    <div class="skel skel-title"></div>
    <div class="skel skel-block"></div>
  </div>

  <!-- Contenu (masqué pendant le chargement) -->
  <div id="detail-content" hidden>

    <!-- ── Header ─────────────────────────────────────── -->
    <header class="detail-header">
      <div class="detail-header-left">
        <button class="btn btn-ghost btn-back" id="btn-back" aria-label="Retour à la liste">
          <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" aria-hidden="true">
            <polyline points="15 18 9 12 15 6"/>
          </svg>
          Prospects
        </button>
        <div class="detail-title-row">
          <h1 class="detail-title" id="detail-nom">—</h1>
          <div class="detail-badges" id="detail-badges"></div>
        </div>
      </div>
      <div class="detail-header-right">
        <span class="detail-commercial" id="detail-commercial-label"></span>
      </div>
    </header>

    <!-- ── Body ───────────────────────────────────────── -->
    <div class="detail-body">

      <!-- Colonne principale -->
      <div class="detail-main">

        <!-- Section : Informations -->
        <section class="detail-section" aria-labelledby="section-infos-title">
          <h2 class="section-title" id="section-infos-title">Informations</h2>
          <div class="info-grid" id="info-grid">
            <!-- Rempli par prospect-detail.js -->
          </div>
        </section>

        <!-- Section : Contacts -->
        <section class="detail-section" aria-labelledby="section-contacts-title">
          <div class="section-header">
            <h2 class="section-title" id="section-contacts-title">Contacts</h2>
            <button class="btn btn-ghost btn-sm" id="btn-new-contact">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" aria-hidden="true">
                <line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/>
              </svg>
              Contact
            </button>
          </div>
          <div class="table-wrap" id="contacts-wrap">
            <table class="data-table" aria-label="Contacts du prospect">
              <thead>
                <tr>
                  <th>Nom</th>
                  <th>Rôle</th>
                  <th>Email</th>
                  <th>Téléphone</th>
                </tr>
              </thead>
              <tbody id="contacts-tbody">
                <!-- Rempli par prospect-detail.js -->
              </tbody>
            </table>
          </div>
        </section>

        <!-- Section : Timeline interactions -->
        <section class="detail-section" aria-labelledby="section-timeline-title">
          <div class="section-header">
            <h2 class="section-title" id="section-timeline-title">Interactions</h2>
            <button class="btn btn-ghost btn-sm" id="btn-new-interaction">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" aria-hidden="true">
                <line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/>
              </svg>
              Interaction
            </button>
          </div>
          <div class="timeline" id="timeline">
            <!-- Rempli par prospect-detail.js -->
          </div>
        </section>

      </div>

      <!-- Colonne latérale -->
      <aside class="detail-aside">

        <!-- Section : Rappels -->
        <section class="detail-section" aria-labelledby="section-rappels-title">
          <div class="section-header">
            <h2 class="section-title" id="section-rappels-title">Rappels</h2>
            <button class="btn btn-ghost btn-sm" id="btn-new-rappel">
              <svg viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5" aria-hidden="true">
                <line x1="12" y1="5" x2="12" y2="19"/><line x1="5" y1="12" x2="19" y2="12"/>
              </svg>
              Rappel
            </button>
          </div>
          <div id="rappels-list">
            <!-- Rempli par prospect-detail.js -->
          </div>
        </section>

      </aside>

    </div><!-- /detail-body -->

  </div><!-- /detail-content -->

</div><!-- /detail-layout -->

<style>
  /* ── Layout ── */
  .detail-layout {
    display: flex;
    flex-direction: column;
    height: 100%;
    overflow: hidden;
    background: var(--color-bg);
  }

  .detail-loading {
    padding: var(--space-8);
    display: flex;
    flex-direction: column;
    gap: var(--space-4);
  }

  /* ── Header ── */
  .detail-header {
    display: flex;
    align-items: flex-start;
    justify-content: space-between;
    padding: var(--space-4) var(--space-6);
    background: var(--color-surface);
    border-bottom: 1px solid var(--color-border);
    flex-shrink: 0;
    gap: var(--space-4);
  }
  .detail-header-left { display: flex; flex-direction: column; gap: var(--space-2); }
  .detail-header-right { display: flex; align-items: center; gap: var(--space-3); flex-shrink: 0; }

  .btn-back {
    display: inline-flex; align-items: center; gap: var(--space-1);
    font-size: var(--text-sm); color: var(--color-text-secondary);
    padding: var(--space-1) 0;
  }
  .btn-back svg { width: 16px; height: 16px; }

  .detail-title-row {
    display: flex; align-items: center; gap: var(--space-3); flex-wrap: wrap;
  }
  .detail-title {
    font-size: var(--text-2xl); font-weight: 700;
    letter-spacing: -.03em; color: var(--color-text);
  }
  .detail-badges { display: flex; gap: var(--space-2); flex-wrap: wrap; }
  .detail-commercial {
    font-size: var(--text-sm); color: var(--color-text-secondary);
  }

  /* ── Body layout ── */
  .detail-body {
    display: grid;
    grid-template-columns: 1fr 300px;
    gap: var(--space-6);
    padding: var(--space-6);
    overflow-y: auto;
    flex: 1;
  }
  @media (max-width: 900px) {
    .detail-body { grid-template-columns: 1fr; }
  }

  /* ── Sections ── */
  .detail-section {
    background: var(--color-surface);
    border: 1px solid var(--color-border);
    border-radius: var(--radius-md);
    overflow: hidden;
    margin-bottom: var(--space-6);
  }
  .section-header {
    display: flex; align-items: center; justify-content: space-between;
    padding: var(--space-4) var(--space-5);
    border-bottom: 1px solid var(--color-border);
  }
  .section-title {
    font-size: var(--text-base); font-weight: 600; color: var(--color-text);
  }

  /* ── Info grid ── */
  .info-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 0;
  }
  .info-field {
    padding: var(--space-3) var(--space-5);
    border-bottom: 1px solid var(--color-border);
  }
  .info-field:nth-last-child(-n+2) { border-bottom: none; }
  .info-label {
    font-size: var(--text-xs); font-weight: 500;
    color: var(--color-text-tertiary);
    text-transform: uppercase; letter-spacing: .05em;
    margin-bottom: var(--space-1);
  }
  .info-value {
    font-size: var(--text-sm); color: var(--color-text);
    word-break: break-word;
  }
  .info-value.empty { color: var(--color-text-tertiary); font-style: italic; }
  .info-value a { color: var(--color-primary); text-decoration: none; }
  .info-value a:hover { text-decoration: underline; }

  /* ── Boutons ── */
  .btn {
    display: inline-flex; align-items: center; gap: var(--space-2);
    font-family: var(--font-sans); font-size: var(--text-sm); font-weight: 600;
    border-radius: var(--radius-sm); border: none; cursor: pointer;
    padding: var(--space-2) var(--space-4);
    transition: background var(--transition-fast);
  }
  .btn-sm { padding: var(--space-1) var(--space-3); font-size: var(--text-xs); }
  .btn svg { width: 14px; height: 14px; }
  .btn-ghost { background: transparent; color: var(--color-text-secondary); }
  .btn-ghost:hover { background: var(--color-surface-alt); }
  .btn-primary { background: var(--color-primary); color: #fff; }
  .btn-primary:hover { background: var(--color-primary-hover); }

  /* ── Table contacts ── */
  .table-wrap { overflow-x: auto; }
  .data-table { width: 100%; border-collapse: collapse; font-size: var(--text-sm); }
  .data-table th {
    padding: var(--space-3) var(--space-4); text-align: left;
    font-weight: 600; color: var(--color-text-secondary);
    background: var(--color-surface-alt); white-space: nowrap;
  }
  .data-table td {
    padding: var(--space-3) var(--space-4);
    border-top: 1px solid var(--color-border);
    color: var(--color-text); vertical-align: middle;
  }

  /* ── Timeline ── */
  .timeline { padding: var(--space-4) var(--space-5); display: flex; flex-direction: column; gap: var(--space-4); }
  .tl-item { display: flex; gap: var(--space-3); }
  .tl-icon {
    width: 32px; height: 32px; border-radius: 50%; flex-shrink: 0;
    display: flex; align-items: center; justify-content: center;
    font-size: var(--text-xs); font-weight: 700;
    background: var(--color-surface-alt); color: var(--color-text-secondary);
    border: 1px solid var(--color-border);
  }
  .tl-icon.email     { background: var(--color-info-soft);    color: var(--color-info); }
  .tl-icon.phone     { background: var(--color-success-soft); color: var(--color-success); }
  .tl-icon.linkedin  { background: #e8f0fe;                   color: #0077b5; }
  .tl-icon.note      { background: var(--color-warning-soft); color: var(--color-warning-dark); }
  .tl-body { flex: 1; min-width: 0; }
  .tl-header { display: flex; align-items: baseline; justify-content: space-between; gap: var(--space-2); margin-bottom: var(--space-1); }
  .tl-title  { font-weight: 600; font-size: var(--text-sm); color: var(--color-text); }
  .tl-date   { font-size: var(--text-xs); color: var(--color-text-tertiary); white-space: nowrap; flex-shrink: 0; }
  .tl-comment { font-size: var(--text-sm); color: var(--color-text); line-height: 1.5; white-space: pre-wrap; }
  .tl-meta  { font-size: var(--text-xs); color: var(--color-text-tertiary); margin-top: var(--space-1); }

  /* ── Rappels ── */
  .rappel-item {
    padding: var(--space-3) var(--space-5);
    border-bottom: 1px solid var(--color-border);
    display: flex; align-items: flex-start; justify-content: space-between; gap: var(--space-3);
  }
  .rappel-item:last-child { border-bottom: none; }
  .rappel-date { font-size: var(--text-xs); color: var(--color-text-tertiary); margin-bottom: var(--space-1); }
  .rappel-motif { font-size: var(--text-sm); font-weight: 500; color: var(--color-text); }

  /* ── Badges ── */
  .badge {
    display: inline-flex; align-items: center;
    padding: 2px var(--space-2); border-radius: 99px;
    font-size: var(--text-xs); font-weight: 600; white-space: nowrap;
  }
  .badge-success   { background: var(--color-success-soft);  color: var(--color-success); }
  .badge-warning   { background: var(--color-warning-soft);  color: var(--color-warning-dark); }
  .badge-danger    { background: var(--color-danger-soft);   color: var(--color-danger); }
  .badge-secondary { background: var(--color-surface-alt);   color: var(--color-text-secondary); }
  .badge-info      { background: var(--color-info-soft);     color: var(--color-info); }

  /* ── Skeleton ── */
  .skel { background: var(--color-border); border-radius: var(--radius-sm); animation: shimmer 1.4s ease-in-out infinite; }
  .skel-title  { height: 28px; width: 260px; }
  .skel-block  { height: 200px; width: 100%; border-radius: var(--radius-md); }
  @keyframes shimmer { 0%, 100% { opacity: 1; } 50% { opacity: .4; } }

  /* ── Empty state ── */
  .empty-state { text-align: center; padding: var(--space-8); color: var(--color-text-tertiary); }
  .empty-state-icon { font-size: 2rem; margin-bottom: var(--space-3); }
  .empty-state p { font-size: var(--text-sm); }

  /* ── Slide panel (scope local) ── */
  .slide-panel {
    position: fixed; top: 0; right: -440px; height: 100vh; width: 440px;
    background: var(--color-surface); border-left: 1px solid var(--color-border);
    box-shadow: -4px 0 24px rgba(0,0,0,.08);
    z-index: 200; transition: right var(--transition-normal);
    display: flex; flex-direction: column;
  }
  .slide-panel.open { right: 0; }
  .slide-panel-header {
    display: flex; align-items: center; justify-content: space-between;
    padding: var(--space-5) var(--space-6); border-bottom: 1px solid var(--color-border); flex-shrink: 0;
  }
  .slide-panel-header h2 { font-size: var(--text-lg); font-weight: 700; color: var(--color-text); }
  .slide-panel-body { flex: 1; overflow-y: auto; padding: var(--space-6); }

  /* ── Form ── */
  .form-field { margin-bottom: var(--space-4); }
  .form-label { display: block; font-size: var(--text-sm); font-weight: 500; color: var(--color-text-secondary); margin-bottom: var(--space-2); }
  .form-input, .form-select, .form-textarea {
    width: 100%; font-family: var(--font-sans); font-size: var(--text-base);
    color: var(--color-text); background: var(--color-surface);
    border: 1px solid var(--color-border-strong); border-radius: var(--radius-sm);
    padding: var(--space-3) var(--space-4);
    transition: border-color var(--transition-fast), box-shadow var(--transition-fast);
  }
  .form-textarea { resize: vertical; min-height: 80px; }
  .form-input:focus, .form-select:focus, .form-textarea:focus {
    outline: none; border-color: var(--color-primary); box-shadow: var(--shadow-focus);
  }
  .form-row { display: grid; grid-template-columns: 1fr 1fr; gap: var(--space-4); }
  .form-actions {
    display: flex; gap: var(--space-3); justify-content: flex-end;
    margin-top: var(--space-6); padding-top: var(--space-4); border-top: 1px solid var(--color-border);
  }
</style>

<!-- ── Init JS géré par router.js → initPageScripts() ────── -->
